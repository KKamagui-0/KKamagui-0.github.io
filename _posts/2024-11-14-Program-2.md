---
title: "[Linux] 셸 스크립트"
date: 2024-11-14 00:34:00 +0900
categories:
  - Language
  - Linux
tags:
  - linux
  - language
  - programing
  - shell_script
---

# Chapter 1. 셸 스크립트
#### 1. 셸 스크립트 프로그래밍
- 셸에서 사용할 수 있는 명령어들을 모아서 만든 파일
- 셸을 이용해서 명령어들을 순차적으로 실행시켜주는 인터프리터
- 특징
	- C 언어와 비슷하게 프로그래밍 가능
	- 변수, 제어문, 반복문 사용 가능
	- 별도의 컴파일이 없고, 텍스트 형태로 바로 실행
	- vi 에디터 혹은 gedit로 작성 가능

<br>

#### 2. 셸의 종류
- sh : 초기의 유닉스 셸
- ksh : 콘 셸이라고 불리며, sh를 확장해서 만든 셸
- csh : C 언어를 기반으로 만든 셸
- bash : sh와 대부분 호환이 되는 셸

<br>

#### 3. 셸 작성 방법
- 확장자명은 .sh
- 파일의 첫 부분에 `#!/bin/sh` 를 선언 = 해당 스크립트 파일을 bash 셸로 실행하겠다.
- `echo` : 파이썬의 `print` 함수와 동일, 개행을 포함하여 출력
- `printf` : C 언어의 `printf` 함수와 동일, 개행을 포함하지 않고 출력
- `exit 0` : 종료 코드 반환, 실제 스크립트 실행과는 무관 하다고 볼 수 있지만, 셸 스크립트는 실행 중간에<br> 문제가 생겨도 실행했다는 자체를 성공으로 보기에 성공 코드를 반환하므로 마지막 행에서<br> 직접 성공 여부를 반환하는 것이 좋음.
	- **`0` : 성공, `1` : 실패** 

<br>

#### 4. 셸의 실행
- 일반적으로 스크립트 파일의 실행 가능 여부는 스크립트 파일 자체의 권한이 아닌 스크립트 파일이 존재하는 **디렉토리의 권한에 따라 결정**
- 스크립트 파일의 실행권한이 없어도 **디렉토리에 실행권한이 있다면 스크립트 파일 실행 가능**
##### 4-1. 셸의 실행 방법 
- `sh test.sh`
- 스크립트 파일에 실행 권한이 있는 경우 : `./test.sh`
- 셸에선 **왼쪽**에 있는 문자는 **변수**, **오른쪽**에 있는 문자는 **값**으로 취급
	- `7 = 칠` : **7**이라는 **변수**에 **칠**이라는 **값**을 **저장**
- 저장된 값을 사용하기
	- `echo $(which bash)` &rarr; **출력**하라, **bash의 위치 값**

<br>
##### 4-2. 셸의 변수 입력
- 셸은 변수를 미리 선언하지 않음, 변수에 값을 초기화하면 선언과 동시에 값이 할당
- 모든 변수는 **문자열**로 취급
- 선언된 변수는 기본적으로 전역변수, 함수 안에서만 지역 변수를 사용할 수 있는데 변수 앞에<br> `local` 을 붙여서 작성
- 변수 대입 시 **=** 좌우에 공백이 없어야함
	- `7 = 칠` : 잘못된 대입
	- `7=칠` : 정상적인 대입
- `$` 문자가 들어간 글자를 출격하고자 하면 **'** 로 묶어주거나 앞에 `￦`를 붙임.

	```
	myvar="hi"
	echo $myvar -> hi
	echo '$myvar' -> $myvar
	echo ￦$myvar -> $myvar
	```
- 숫자 계산
	- `expr`
		- 변수에 대입된 값은 모두 문자열로 취급
		- 변수에 들어있는 값을 숫자로 해석하기 위해선 `expr`를 사용
		- `expr` 사용 시  \`(backtick)으로 감싸서 사용
		- 사칙연산 시 피연산자와 연산자 사이에 공백 필요
		- 괄호 사용을 위해선 `￦`를 사용
		- 곱셈 문자 `*`에는 다른 명령(`all`) 과 중복되므로 `￦`를 붙여서 사용
	```
		num1=100 -> 문자열 100 num1에 대입
		num2=$num1 + 200 -> 문자열 100+200 num2에 대입
		num3=`expr$num1 + 200` -> 숫자 100+200 계산 후 num3에 대입
	```
	- `let`
		- 변수의 사칙연산 앞에 `let`을 입력 후 작성
			```
				num1=10
				num2=10
				let result=num1+num2 -> 값 20이 result에 대입
			```
	- `$(())`
		- 변수 출력 시 사칙연산을 사용하여 계산 후 출력
			```
				num1=10
				num2=10
				echo add:$((num1+num2)) -> 값 20 출력
			```
- 파라미터 변수
	- 파라미터 변수의 형태는 `$0`,`$1`.... 와 같은 형태
	- `$0` : 실행된 셸 스크립트의 이름
	- `$1 ~ 4` : 스크립트에 넘겨진 인자 값
	- `$#` : 총 인자 값의 수
	- 전체 파라미터는 `$*`로 표현
- 변수 타입의 지정
	- `declare` : 변수의 타입을 지정하기 위한 문법
		- `declare -i num=123` &rarr; 변수 num의 타입은 정수형
	- `-r` : 읽기 전용(상수 const)
	- `-i` : 정수형
	- `-a` : 배열
	- `-A` : 연관 배열
	- `-f` : 함수
	- `-x` : 환경 변수
- 환경 변수
	- 변수 명 앞에 `export`를 붙이면 **환경변수**로 설정.
	- 자식 스크립트에서 사용 가능하며 예약 변수명과 변수명이 겹치지 않도록 주의 해야함
- 조건문(if)
	- 특이점
		- fi의 사용과 \[]의 사용
	- if로 시작해서 조건문 마지막엔 fi로 조건문의 끝을 알려야함
	- 조건문은 \[]안에 작성하며, 조건식 사이에는 **반드시** **공백**이 있어야함
		```
			if[조건]
			then
				참 일 경우 실행
			else
				거짓일 경우 실행
			fi
		```
- 조건문(case)
	- 특이점
		- 각 조건문(case) 끝에 ;; 로 종료
		- 패턴 사용 가능
	- C 언어의 switch case 문법과 동일
		```
			case 조건 문자열 in
			조건 문자열 1)
				명령
				;;
			조건 문자열 2)
				명령
				;;
			esac
		```
- 반복문(for)
	- Java의 for 문법과 동일
	- 반복문 종료 : `break`
	- 현재 조건 건너뛰기 : `continue`
		```
			for(초기값;조건값;증가값;); do
				echo
			done
		```
	- `sequencial` : 일정한 규칙이 적용된 연속된 값
	- `none-sequencial` : 규칙이 없는 연속된 값
		```
			seq 1 .1 10 -> 1.0 , 1.1 , 1.2 .... 생략
		```
- 반복문(while)
	- 수행 조건이 True 일 때 실행되는 반복문
	```
	count = 0
	while (($count <= 5));
	do
		echo $count
		count=$(($count + 1))
	done
	```
- 반복문(until)
	- 수행 조건이 false일 때 실행되는 반복문
	- do while과 비슷함
	```
	count=10
	until[$count -le 5]; do
		echo $count
		count=$(($count - 1))
	done
	```
- 배열
	- 배열의 크기 지정 없이 배열 변수 선언
	- `declare` 명령어로 타입을 지정하지 않아도 사용 가능
	- 리눅스는 1차원 배열만 지원
	```
	arr=("test1""test2""test3") -> 배열 선언 및 지정
	echo ${arr[0]} -> test1 출력
	echo ${#arr[@]} -> 배열 길이 출력력
	```
	- 배열의 원소 삭제
		- / 를 사용하여 해당 문자열 부분이 있으면 삭제 가능
		- `unset` 명령어를 통해 삭제에 대한 내용 권고
		```
		arr=("abc""def""deff")
		unset arr[1] -> 배열 인덱스 1번 삭제
		echo ${arr[@]} -> abc, deff만 출력됨
		unset arr -> 배열 전체 삭제
		```
	- 연관 배열(MAP)
		- Key와 Value 타입으로 저장된 배열
		- 파이썬의 딕셔너리, JS의 Map과 비슷
- 사용자 입력 값 받아오기
	- 사용자로부터 인자값을 받아 변수로 사용
	```
	echo -n "사용자 입력 값 : "
	read [변수명]
	echo "사용자가 입력한 값 : $변수명"
	```